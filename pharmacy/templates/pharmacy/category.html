{% extends 'pharmacy/base.html' %}
{% load crispy_forms_tags %}
{% block content %}

<div class="container pt-5 pr-5">

    <div class="row">
        <div class="col-8">
            <div class="fw-bold fs-3 pb-1" style="display: flex;">
                <lottie-player src="https://assets8.lottiefiles.com/packages/lf20_vvjhceqy.json" background="transparent" speed="1" style="height: 60px;width:60px" loop autoplay></lottie-player>
<span style="margin-top:10px">فئات الأدوية | </span>


            <a href="http://127.0.0.1:8000/pharmacy/{{profile_user.username}}/category/new_category/" type="button"
                   class="btn btn-dark" style="margin-bottom:20px;margin-top:12px">
                    <i class="fas fa-folder-plus"></i> اضف فئة </a></div>
        </div>
        <div class="col-4">


        </div>
    </div>



{% if categories %}

    <table class="table">
        <thead class="table-dark">
        <th scope="col">#</th>
        <th scope="col">اسم الفئة</th>
        <th scope="col">وصف الفئة</th>
        <th scope="col">تعديل</th>
        </thead>
        <tbody>

        {% for cat in categories %}
        <tr>
            <th scope="row">{{ forloop.counter }}</th>
            <td>{{cat.name}}</td>
            <td>{{cat.description}}</td>
            <td>
                <a href="http://127.0.0.1:8000/pharmacy/{{profile_user.username}}/category/update_category/{{cat.id}}/"
                   type="button" class="btn btn-dark">
                    <i class="far fa-edit fa-sm"></i>
                </a>
            </td>
        </tr>

        {% endfor %}

        </tbody>
    </table>

{% endif %}

        <form class="card card-sm">
        <div class="card-body row no-gytters align-items-center">
            <div class="col">
                <input type="search" name="item_name" placeholder="ابحث باسم الفئة"
                       class="form-control form-control-borderless" id="tags">
                <script>
                    $(function () {
                        var availableTags = [
                            {% for cat in category_all %}"{{cat.name}}", {% endfor %}
                                ];
                    $("#tags").autocomplete({
                        source: availableTags,
                        select: function (event, ui) {
                            $("#tags").val(ui.item.label);
                            $("#tags").val(ui.item.value);
                            this.form.submit();
                        }
                    });

                            } );
                </script>
            </div>

        </div>
    </form>


    <table class="table">
        <thead class="table-dark">
        <th scope="col">#</th>
        <th scope="col">اسم الفئة</th>
        <th scope="col">وصف الفئة</th>
        <th scope="col">تعديل</th>
        </thead>
        <tbody>

        {% for cat in category %}
        <tr>
            <th scope="row">{{ forloop.counter }}</th>
            <td>{{cat.name}}</td>
            <td>{{cat.description}}</td>
            <td>
                <a href="http://127.0.0.1:8000/pharmacy/{{profile_user.username}}/category/update_category/{{cat.id}}/"
                   type="button" class="btn btn-dark">
                    <i class="far fa-edit fa-sm"></i>
                </a>
            </td>
        </tr>

        {% endfor %}

        </tbody>
    </table>


</div>

<div class="container pt-2 pb-3 text-right">

    <nav aria-label="...">
        <ul class="pagination">

            <li class="page-item">
                {% if category.has_previous %}
                <a class="page-link" href="?page={{category.previous_page_number}}" tabindex="-1" aria-disabled="true">الصفحة
                    السابقة</a>
                {% else %}
                <a class="page-link disabled" tabindex="-1" aria-disabled="true">الصفحة السابقة</a>
                {% endif %}
            </li>


            {% for n in category.paginator.page_range %}
            {% if category.number == n %}
            <li class="page-item active">
                <span class="page-link">{{ n }}<span class="sr-only">(current)</span></span>
            </li>
            {% elif n > category.number|add:'-3' and n < category.number|add:'3' %}
            <li class="page-item"><a class="page-link" href="?page={{ n }}">{{ n }}</a></li>
            {% endif %}
            {% endfor %}


            <li class="page-item">
                {% if category.has_next %}
                <a class="page-link" href="?page={{category.next_page_number}}">الصفحة التالية</a>
                {% else %}
                <a class="page-link disabled" href="#">الصفحة التالية</a>
                {% endif %}
            </li>


        </ul>
    </nav>

</div>

{% endblock %}